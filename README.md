# Bank Widget

## Описание:

Это виджет, который показывает несколько последних успешных банковских операций клиента в его личном кабинете.

Проект находится в стадии разработки.

## Установка:

Рекомендуется использовать PyCharm

Ссылка для добавления проекта
[git@github.com:kirillbarkhatov/bank_widget.git]()

Для создания виртуального окружения и установки зависимостей используйте Poetry

Модуль `external_api` использует сервис https://apilayer.com. Создайте `.env` из `.env.example` и добавьте токен API в `.env` как описано в шаблоне

## Использование:

На текущий момент подготовлено к использованию 7 модулей:
1. `decorators`
2. `external_api`
3. `generators`
4. `masks`
5. `processing`
6. `utils`
7. `widget`

Описания функций приведены в докстрингах

Для модулей `masks` и `utils` реализовано логирование

Поддерживается чтение данных о транзакциях из файлов формата `json`, `csv` и `xlsx`


## Функционал

На текущий момент в проекте реализованы следующие функции

`masked_card_number` Функция принимает на вход номер карты и возвращает ее маску формате XXXX XX** **** XXXX

`masked_account_number` Функция принимает на вход номер счета и возвращает его маску в формате **XXXX

`masked_numbers` Функция принимает данные карты или счета и маскирует часть их номера

`convert_date` Функция вернет дату в формате ДД.ММ.ГГГГ

`filter_by_state` Функция принимает на вход список словарей и возвращает новый список,
    в котором исходные словари отсортированы по убыванию даты (ключ date).
    Функция принимает два аргумента, второй необязательный задает
    порядок сортировки (убывание, возрастание)
    
`filter_by_currency` Функция - генератор принимает список словарей с банковскими операциями
    (или объект-генератор, который выдает по одной банковской операции)
    и возвращает итератор, который выдает по очереди операции, в которых указана заданная валюта
    
`transaction_descriptions` Функция - генератор, который принимает список словарей
    и возвращает описание каждой операции по очереди
    
`card_number_generator` Генератор номеров банковских карты - диапазоны передаются как параметры генератора

`log` Декоратор - логирует вызов функции и ее результат в файл или в консоль.
    Декоратор принимает один необязательный аргумент filename,
    который определяет путь к файлу, в который будут записываться логи.
    Если filename не задан, то логи будут выводиться в консоль.
    Если вызов функции закончился ошибкой, то записывается сообщение об ошибке и входные параметры функции.

    Пример использования:
        @log(filename="mylog.txt")
        def my_function(x, y):
            return x + y

        my_function(1, 2)
    
`currency_converter` Функция обеспечивает обращение к внешнему API для получения текущего курса валют
    и конвертации суммы операции в рубли
    
`get_transactions_from_xls` Функция принимает на вход путь до CSV-файла и возвращает список словарей с данными о финансовых транзакциях.
    Если файл не найден, функция возвращает пустой список.
    
`get_transactions_from_csv` Функция принимает на вход путь до CSV-файла и возвращает список словарей с данными о финансовых транзакциях.
    Если файл не найден, функция возвращает пустой список.
    
`get_transactions_from_json` Функция принимает на вход путь до JSON-файла и возвращает список словарей с данными о финансовых транзакциях.
    Если файл пустой, содержит не список или не найден, функция возвращает пустой список.
    
`get_transaction_amount` Функция принимает на вход транзакцию и возвращает сумму транзакции (amount) в рублях, тип данных — float.
    Если транзакция была в USD или EUR, происходит обращение к внешнему API для получения текущего курса валют
    и конвертации суммы операции в рубли


## Документация:

Раздел в разработке

## Тестирование:

Код в модулях пакета `src/` покрыт тестами на 100%.
Для запуска тестов используйте команду `pytest`

Для проверки покрытия тестами используйте команду `pytest --cov`


## Лицензия:

Раздел в разработке